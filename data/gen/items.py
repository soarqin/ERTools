#!/usr/bin/env python3
# -*- coding: UTF-8 -*-

import codecs
import string
import sys
import os
import json

sep = string.whitespace + string.punctuation

weapons = [
    {
        'category': 60010,
        'items': [1000000, 1020000, 1030000, 1090000, 1140000, 1150000, 1100000, 1060000, 1130000, 1050000, 1080000, 1110000, 1070000, 1040000, 1160000, 1010000]
    },
    {
        'category': 60015,
        'items': [2010000, 2000000, 2020000, 2050000, 2040000, 2230000, 2210000, 2240000, 2250000, 2180000, 2150000, 2260000, 2200000, 2060000, 2070000, 2190000, 2220000, 2110000, 2140000]
    },
    {
        'category': 60020,
        'items': [3000000, 3180000, 3020000, 3030000, 3040000, 3080000, 3010000, 3050000, 3190000, 3210000, 2090000, 3160000, 3150000, 3060000, 3070000, 3200000, 3130000, 3140000, 3170000, 3090000, 3100000]
    },
    {
        'category': 60025,
        'items': [4040000, 4000000, 4010000, 4030000, 4110000, 4060000, 4100000, 4080000, 4050000, 4070000, 4020000]
    },
    {
        'category': 60045,
        'items': [5020000, 5000000, 5060000, 5010000, 5030000, 5040000, 5050000]
    },
    {
        'category': 60046,
        'items': [6020000, 6010000, 6000000, 6040000]
    },
    {
        'category': 60030,
        'items': [7140000, 7000000, 7030000, 7150000, 7040000, 7020000, 7080000, 7120000, 7010000, 7060000, 7110000, 7050000, 2080000, 7070000, 7100000]
    },
    {
        'category': 60035,
        'items': [8020000, 8060000, 8070000, 8080000, 8030000, 8010000, 8050000, 8040000, 8100000]
    },
    {
        'category': 60040,
        'items': [9000000, 9010000, 9080000, 9030000, 9060000, 9040000, 9070000, 9020000]
    },
    {
        'category': 60043,
        'items': [10000000, 10030000, 10010000, 10080000, 10090000, 10050000]
    },
    {
        'category': 60050,
        'items': [14010000, 14020000, 14000000, 15010000, 14030000, 14040000, 14100000, 14060000, 14110000, 14080000, 14050000, 14140000, 14120000]
    },
    {
        'category': 60055,
        'items': [15000000, 15030000, 15050000, 15080000, 15020000, 15060000, 15120000, 15130000, 15140000, 15110000, 15040000]
    },
    {
        'category': 60060,
        'items': [11010000, 11030000, 11070000, 11140000, 11000000, 11050000, 11040000, 11080000, 11090000, 11060000, 11100000, 11120000, 11130000, 11110000, 11150000]
    },
    {
        'category': 60065,
        'items': [12000000, 12080000, 12060000, 12140000, 12190000, 12020000, 12210000, 12130000, 12180000, 12010000, 12160000, 12170000, 12150000, 12200000]
    },
    {
        'category': 60067,
        'items': [13010000, 13000000, 13040000, 13020000, 13030000]
    },
    {
        'category': 60102,
        'items': [23040000, 23150000, 23120000, 23110000, 23000000, 23020000, 23130000, 23060000, 23010000, 23070000, 23140000, 23030000, 23100000, 23080000, 23050000]
    },
    {
        'category': 60070,
        'items': [16000000, 16150000, 16010000, 16050000, 16070000, 16140000, 16110000, 16030000, 16060000, 16080000, 16130000, 16020000, 16160000, 16040000, 16120000, 16090000]
    },
    {
        'category': 60077,
        'items': [17060000, 17070000, 17030000, 17020000, 17050000, 17010000]
    },
    {
        'category': 60080,
        'items': [18000000, 18030000, 18020000, 18090000, 18130000, 18070000, 18110000, 18150000, 18160000, 18050000, 18010000, 18060000, 18080000, 18140000, 18100000, 18040000]
    },
    {
        'category': 60085,
        'items': [19000000, 19010000, 19020000, 19060000]
    },
    {
        'category': 60155,
        'items': [20000000, 20020000, 20070000, 20050000, 20030000, 20060000]
    },
    {
        'category': 60090,
        'items': [21000000, 21010000, 21100000, 21070000, 21080000, 21110000, 21120000, 21130000, 21060000]
    },
    {
        'category': 60100,
        'items': [22000000, 22010000, 22020000, 22030000]
    },
    {
        'category': 60104,
        'items': [40000000, 40050000, 40020000, 40010000, 40030000]
    },
    {
        'category': 60105,
        'items': [41000000, 41010000, 41070000, 41060000, 41020000, 41040000, 41030000]
    },
    {
        'category': 60110,
        'items': [42040000, 42010000, 42030000, 42000000]
    },
    {
        'category': 60115,
        'items': [43000000, 43020000, 43030000, 43080000, 43110000, 43050000, 43060000]
    },
    {
        'category': 60117,
        'items': [44000000, 44010000]
    },
    {
        'category': 60120,
        'items': [33130000, 33000000, 33200000, 33120000, 33060000, 33230000, 33240000, 33210000, 33170000, 33090000, 33190000, 33280000, 33050000, 33040000, 33270000, 33250000, 33260000, 33180000]
    },
    {
        'category': 60130,
        'items': [34000000, 34070000, 34060000, 34030000, 34020000, 34010000, 34040000, 34090000, 34080000]
    },
    {
        'category': 60175,
        'items': [24000000, 24060000, 24020000, 24070000, 24050000, 24040000]
    },
    {
        'category': 60140,
        'items': [30030000, 30090000, 30100000, 30080000, 30070000, 30040000, 30000000, 30120000, 30130000, 30020000, 30140000, 30110000, 30010000, 31170000, 30190000, 30150000, 30200000]
    },
    {
        'category': 60145,
        'items': [31270000, 31240000, 31250000, 31260000, 31020000, 31050000, 31070000, 31230000, 31340000, 31010000, 31330000, 31300000, 31290000, 31280000, 31320000, 31310000, 31000000, 31100000, 31030000, 31080000, 31090000, 31130000, 31040000, 30060000, 31190000, 31060000, 31140000]
    },
    {
        'category': 60150,
        'items': [32290000, 32300000, 32050000, 32170000, 32140000, 32090000, 32190000, 32200000, 32210000, 32000000, 32020000, 32270000, 32250000, 32230000, 32260000, 32280000, 32030000, 32040000, 32130000, 32240000, 32220000, 32080000, 32120000, 32160000, 32150000,]
    }
]
arrows = [50000000, 50010000, 50020000, 50030000, 50040000, 50060000, 50080000, 50090000, 50100000, 50110000, 50130000, 50140000, 50150000, 50160000, 50170000, 50180000, 50190000, 50200000, 50210000, 50220000, 50230000, 50240000, 50260000, 50270000, 50280000, 50290000, 50300000, 50310000, 50320000, 50330000, 50340000, 50350000, 51000000, 51010000, 51020000, 51030000, 51040000, 51050000, 51060000, 52000000, 52010000, 52020000, 52030000, 52040000, 52050000, 52060000, 52070000, 52080000, 52090000, 52100000, 52110000, 52120000, 52130000, 52140000, 52150000, 52160000, 52170000, 52180000, 52190000, 53000000, 53010000, 53020000, 53030000]
protectors = [1020100, 1020200, 1020300, 810000, 811000, [810100,811100], [812000,812100], 810300, 370000, 380000, 370100, 371100, 380100, 370300, 390000, 390100, 390300, 220000, [220100,221100], 220300, 1990000, [1990100,1991100], 330000, 331100, 330100, 330200, 330300, [800000,801000], 800100, 801100, 802000, 802100, 160000, 160100, 160300, 890000, 890100, 890300, 891000, 964000, 964100, 963200, 2020000, 1130000, 2010000, 1130100, 1130200, 1130300, 630000, [630100,631100], 630200, 630300, 1030000, 1030100, 833000, 831000, 830000, 834000, 830100, 830200, 830300, 832000, 2030000, 1000000, 1000100, 1000200, 1000300, 990000, [990100,991100], 990200, 990300, 130000, [130100,131100], 130200, 130300, [120000,121000], [120100,121100], 120200, 120300, 910000, [910100,911100], 910200, 910300, 911000, 581000, 581100, 581200, 580000, 580100, 580200, 580300, 510000, 510100, 510200, 510300, 1010000, [1010100,1011100], 1010300, 1940000, [1940100,1941100], 1930100, 620000, [621100,622100], 620300, 620100, 900000, [900100,901100], 900200, 900300, 902000, [902100,903100], 902300, 430000, 430100, 430300, 1600000, 1040000, 1040100, 1040200, 1040300, 90000, [90100,91100], 90200, 90300, 100000, [100100,101100], 100200, 100300, 540000, [540100,541100], 540200, 540300, 962100, 961000, 961100, 960000, 960100, 960300, 963000, 963100, 300000, 300100, 300300, 301000, 301100, 301300, 520000, 520100, 520200, 520300, 530000, 530100, 530200, 530300, 1050100, 320000, 320100, 320300, [480100,481100], 1910000, 1920000, 1900000, 1902000, 1901000, 1080000, 1084000, 1081000, 1082000, 1083000, 1085000, 1300000, 1301000, 1090000, 820000, 1110000, 1120000, 1060000, 1060100, 1400000, 1400100, 1400200, 1400300, 670000, 670100, 670200, 670300, 740000, 741000, 740100, 740200, 740300, 680000, [680100,681100], 680200, 680300, 250000, [250100,251100], 250300, 1401000, 931100, 930200, 930300, [880000,881000], [880100,881100], 880200, 880300, 1890000, 1890100, 1890200, 1890300, 930000, 930100, 1830000, 1830100, 1830200, 1830300, 1840000, 1840100, 1860000, 1860100, 1850000, 1850100, 1880000, 1880100, 1870100, 1980000, 1980100, 1980200, 420000, 420100, 420200, 420300, 310000, [310100,311100], 310300, 2000000, [2000100,2001100], 2000300, [290000,291000], [290100,291100], 290200, 290300, [292000,294000], [292100,294100], 293000, 293100, 730000, 730100, 730200, 730300, 1100000, 1100100, 1102100, 1101100, 1100200, 1100300, 40000, 40100, 40200, 40300, 1700000, 1700100, 1700200, 1700300, 1710000, 1710100, 1710200, 1710300, 1730000, 1730100, 1730200, 1730300, 1720000, 1720100, 1720200, 1720300, 1750000, 1750100, 1750200, 1750300, 1740100, 1740200, 1740300, 190000, 190100, 190200, 190300, 50000, 50100, 50200, 50300, 870000, [870100,871100], 870200, 870300, 872000, 872100, 872200, 872300, 150000, [150100,151100], 150200, 150300, [940000,941000], 940100, 940200, 940300, 840000, 850000, 840100, 240000, [240100,241100], 240200, 240300, 350000, 350100, 350200, 350300, 351000, 351100, 351200, 351300, 1070000, 1070100, 1070200, 1070300, 180000, [180100,181100], 180200, 180300, 770000, [770100,771100], 770200, 770300, 460000, [460100,461100], 460200, 460300, 1500000, 1500100, 1500200, 1500300, 660000, [660100,661100], 660200, 660300, 1101000, 980000, [980100,981100], 980200, 980300, 1770000, [1770100,1771100], 1770200, 1770300, 1780000, [1780100,1781100], 1780200, 1780300, 1800000, [1800100,1801100], 1800200, 1800300, 1760000, [1760100,1761100], 1760200, 1760300, 1790000, [1790100,1791100], 1790200, 1790300, 1820000, [1820100,1821100], 1820200, 1820300, [1810100,1811100], 1810200, 1810300, 790000, [790100,791100], 790200, 790300, [340000,341000], [340100,341100], 340200, 340300, 860000, [860100,861100], 860200, 860300, 650000, 651000, [650100,652100], 650200, 650300, 600000, [600100,601100], 600200, [600300,601300], [60000,61000], [60100,61100], 60200, 60300, 170000, [170100,171100], 170200, 170300, 210000, [210100,211100], 210200, 210300, 950000, [950100,951100], 950200, 950300, 690000, 690100, 690200, 690300, 590000, [590100,591100], 590200, 590300, 280000, [280100,281100], 280200, 280300, 760000, [760100,761100], 760200, 760300, 200000, 201000, 200100, 201100, 200200, 200300, [230000,231000], [230100,231100], 230200, 230300, 780000, [780100,781100], 780200, 780300, 80000, [80100,81100], 80200, 80300, 720000, [720100,721100], 720200, 720300, 270000, [270100,271100], 270200, 270300, 260000, 260100, 260200, 260300, 570000, [570100,572100], 570200, 570300, 571000, [571100,573100], 470000, [470100,471100], 470200, 470300, 640000, [640100,641100], 640200, 640300, 140000, 140100, 140200, 140300, 970000, 970100, 970200, 970300, 360000, 360100, 361100, 360200, 360300, 440000]
accessories = [1000, 1001, 1002, 5000, 5020, 1010, 1011, 1012, 5010, 1020, 1021, 1022, 1150, 1030, 1031, 1032, 1040, 1041, 1042, 1050, 1051, 1220, 1221, 1060, 1070, 1080, 1090, 4000, 4001, 4002, 4003, 4010, 4011, 4012, 4020, 4021, 4022, 4030, 4031, 4032, 4040, 4041, 4042, 4050, 4051, 4052, 1170, 1171, 1160, 1161, 1180, 1181, 1200, 1201, 1190, 1191, 2090, 2200, 2120, 2130, 2070, 2060, 2140, 2180, 4100, 2150, 2100, 3000, 3001, 3040, 3050, 3080, 1140, 3060, 3070, 2190, 2210, 2220, 6020, 1230, 1231, 3090, 1210, 2110, 2000, 2020, 2010, 2030, 4060, 4070, 4110, 2040, 4080, 2050, 4090, 5050, 5060, 2080, 2081, 1250, 5040, 2170, 2160, 5030, 6110, 1110, 1100, 6000, 6010, 6040, 6080, 6090, 6050, 6060]
sorceries = [4000, 4010, 4001, 4020, 4021, 4030, 4040, 4050, 4070, 4060, 4090, 4080, 4120, 4100, 4110, 4460, 4470, 4140, 4130, 4630, 4200, 4220, 4210, 4390, 4300, 4301, 4302, 4370, 4380, 4381, 4360, 4361, 4440, 4430, 4450, 4431, 4480, 4640, 4600, 4610, 4620, 6500, 4660, 4670, 4650, 4800, 4820, 4810, 4830, 4400, 4420, 4490, 4410, 4500, 4520, 4510, 4720, 4721, 4710, 4700, 4701, 5100, 5110, 4900, 4910, 5000, 5001, 5010, 5020, 5030]
incantations = [6420, 6421, 6422, 6423, 6440, 6441, 6460, 6450, 6470, 6480, 6490, 6400, 6520, 6530, 6510, 6600, 6330, 7903, 6340, 6410, 6424, 6430, 6431, 7520, 7500, 7510, 6720, 7530, 6700, 6701, 6710, 6750, 6780, 6770, 6740, 6760, 6730, 6900, 6920, 6930, 6940, 6910, 6950, 6941, 6921, 5040, 6960, 6971, 6970, 6000, 6001, 6010, 6100, 6020, 6110, 6220, 6030, 6120, 6040, 6060, 6050, 7900, 6210, 6230, 6240, 6250, 6260, 6270, 6820, 6830, 6800, 6810, 6850, 6840, 7210, 6300, 6310, 6320, 7220, 7200, 7230, 7240, 7310, 7311, 7320, 7330, 7300, 7000, 7001, 7010, 7011, 7040, 7041, 7030, 7031, 7020, 7021, 7050, 7060, 7080, 7090]
ashesofwar = [10600, 10700, 11000, 10000, 60700, 50300, 70000, 50600, 21200, 50900, 65100, 65000, 65400, 65300, 10300, 10100, 10200, 10900, 11200, 12400, 11400, 80000, 80100, 80200, 65200, 11500, 10500, 11100, 11600, 21000, 12200, 12300, 50200, 22000, 22500, 60000, 60100, 20300, 20000, 21900, 21800, 12000, 11800, 20900, 50800, 21400, 50500, 20700, 11300, 22100, 21600, 21700, 50400, 20100, 20800, 22200, 60400, 60500, 21300, 50700, 60300, 70100, 70200, 22800, 11900, 22400, 20400, 10800, 60600, 20200, 22700, 50100, 22600, 20500, 85000, 60200, 40200, 40000, 40100, 40500, 40400, 40600, 30200, 30700, 30600, 30000, 30800, 30100, 31000, 30500, 30900]
spirits = [240000, 241000, 205000, 215000, 212000, 213000, 211000, 210000, 234000, 222000, 214000, 232000, 235000, 233000, 237000, 244000, 236000, 245000, 203000, 246000, 249000, 248000, 220000, 242000, 225000, 226000, 231000, 243000, 227000, 209000, 230000, 229000, 208000, 224000, 218000, 219000, 250000, 251000, 252000, 253000, 255000, 254000, 238000, 201000, 202000, 239000, 221000, 204000, 217000, 216000, 247000, 228000, 256000, 257000, 258000, 223000, 200000, 207000, 261000, 263000, 262000, 259000, 260000, 206000]

idmap = {}

def load_text(lang):
    global idmap
    for l in codecs.open('text\\' + lang + '\\WeaponName.txt', 'r', 'utf-8').readlines():
        l = l.strip()
        index = l.find('\t')
        if index < 0:
            continue
        idmap['W' + l[:index]] = l[index+1:]
    for l in codecs.open('text\\' + lang + '\\ProtectorName.txt', 'r', 'utf-8').readlines():
        l = l.strip()
        index = l.find('\t')
        if index < 0:
            continue
        idmap['P' + l[:index]] = l[index+1:]
    for l in codecs.open('text\\' + lang + '\\AccessoryName.txt', 'r', 'utf-8').readlines():
        l = l.strip()
        index = l.find('\t')
        if index < 0:
            continue
        idmap['ACC' + l[:index]] = l[index+1:]
    for l in codecs.open('text\\' + lang + '\\GemName.txt', 'r', 'utf-8').readlines():
        l = l.strip()
        index = l.find('\t')
        if index < 0:
            continue
        idmap['AOW' + l[:index]] = l[index+1:]
    for l in codecs.open('text\\' + lang + '\\GoodsName.txt', 'r', 'utf-8').readlines():
        l = l.strip()
        index = l.find('\t')
        if index < 0:
            continue
        idmap['G' + l[:index]] = l[index+1:]
    for l in codecs.open('text\\' + lang + '\\GR_MenuText.txt', 'r', 'utf-8').readlines():
        l = l.strip()
        index = l.find('\t')
        if index < 0:
            continue
        idmap['M' + l[:index]] = l[index+1:]

def generate(lang):
    global idmap
    idmap = {}
    load_text('engus')
    load_text(lang)

    # Weapons
    o = []
    for v in weapons:
        cate = idmap['M' + str(v['category'])]
        o2 = []
        for i in v['items']:
            o3 = {}
            o3['id'] = i
            o3['name'] = idmap['W' + str(i)]
            o2.append(o3)
        o.append({'category': cate, 'items': o2})
    os.makedirs('../' + lang, exist_ok=True)
    codecs.open('../' + lang + '/weapons.json', 'w', 'utf-8').write(json.dumps(o, ensure_ascii=False, indent=2))

    # Arrows
    o = []
    for v in arrows:
        o.append({'id': v, 'name': idmap['W' + str(v)]})
    os.makedirs('../' + lang, exist_ok=True)
    codecs.open('../' + lang + '/arrows.json', 'w', 'utf-8').write(json.dumps(o, ensure_ascii=False, indent=2))

    # Protectors
    o = []
    for v in protectors:
        if isinstance(v, list):
            name = ''
            for k in v:
                if len(name) == 0:
                    name = idmap['P' + str(k)]
                else:
                    name = name + '/' + idmap['P' + str(k)]
        else:
            name = idmap['P' + str(v)]
        o.append({'id': v, 'name': name})
    os.makedirs('../' + lang, exist_ok=True)
    codecs.open('../' + lang + '/protectors.json', 'w', 'utf-8').write(json.dumps(o, ensure_ascii=False, indent=2))

    # Accessories
    o = []
    for v in accessories:
        o.append({'id': v, 'name': idmap['ACC' + str(v)]})
    os.makedirs('../' + lang, exist_ok=True)
    codecs.open('../' + lang + '/accessories.json', 'w', 'utf-8').write(json.dumps(o, ensure_ascii=False, indent=2))

    # Sorceries
    o = []
    for v in sorceries:
        o.append({'id': v, 'name': idmap['G' + str(v)]})
    os.makedirs('../' + lang, exist_ok=True)
    codecs.open('../' + lang + '/sorceries.json', 'w', 'utf-8').write(json.dumps(o, ensure_ascii=False, indent=2))

    # Incantations
    o = []
    for v in incantations:
        o.append({'id': v, 'name': idmap['G' + str(v)]})
    os.makedirs('../' + lang, exist_ok=True)
    codecs.open('../' + lang + '/incantations.json', 'w', 'utf-8').write(json.dumps(o, ensure_ascii=False, indent=2))

    # Ashes of war
    o = []
    for v in ashesofwar:
        o.append({'id': v, 'name': idmap['AOW' + str(v)]})
    os.makedirs('../' + lang, exist_ok=True)
    codecs.open('../' + lang + '/ashesofwar.json', 'w', 'utf-8').write(json.dumps(o, ensure_ascii=False, indent=2))

    # Spirits
    o = []
    for v in spirits:
        o.append({'id': v, 'name': idmap['G' + str(v)]})
    os.makedirs('../' + lang, exist_ok=True)
    codecs.open('../' + lang + '/spirits.json', 'w', 'utf-8').write(json.dumps(o, ensure_ascii=False, indent=2))


if __name__ == '__main__':
    for f in os.listdir('text'):
        if os.path.isdir('text/' + f):
            print('Generates', f)
            generate(f)
